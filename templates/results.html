{% extends 'base.html' %}

{% block content %}
    {% if result_list.status_file == True %}
        <h2>Result - your file is INFECTED </h2>
    {% elif result_list.status_file != True %}
        <h2>Result - your file is CLEAR</h2>
    {% endif %}
    {% csrf_token %}

    {% if result_list.status_file == True %}
    <p>Name your files - {{ result_list.name }}</p>
    <p>{{ result_list.autoexec }}</p>
    <p>{{ result_list.suspicious }}</p>
    <p>{{ result_list.hex_obfuscated }}</p>
    <p>{{ result_list.iocs }}</p>
    <p>{{ result_list.base64 }}</p>
    <p>{{ result_list.dridex_obfuscated }}</p>
    <p>{{ result_list.vba_obfuscated }}</p>
    {% endif %}



    <button onclick="showHide('block_id')" class="dopinfo">Show/hide additional information</button>
    {% if result_list.status_file == False %}
    <div id="block_id" style="display: none;"> In your file, was not found VBA macro</div>
    {% endif %}
    <div id="block_id" style="display: none;">
        {% for det in details %}
            {{ det.kwtype }} - {{ det.keyword }} - {{ det.descr }} <br>
        {% endfor %}
    </div>

<script type="text/javascript">
function showHide(element_id) {
    //Если элемент с id-шником element_id существует
    if (document.getElementById(element_id)) {
        //Записываем ссылку на элемент в переменную obj
        var obj = document.getElementById(element_id);
        //Если css-свойство display не block, то:
        if (obj.style.display != "block") {
            obj.style.display = "block"; //Показываем элемент
        }
        else obj.style.display = "none"; //Скрываем элемент
    }
    //Если элемент с id-шником element_id не найден, то выводим сообщение
    else alert("Элемент с id: " + element_id + " не найден!");
}
</script>


{% endblock %}

