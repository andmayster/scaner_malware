from django.db import models

# Create your models here.

from django.db import models


class Book(models.Model):
    title = models.CharField(max_length=100)
    author = models.CharField(max_length=100)
    doc = models.FileField(upload_to='docs/')


    def __str__(self):
        return self.title

    def delete(self, *args, **kwargs):
        self.doc.delete()
        self.cover.delete()
        super().delete(*args, **kwargs)


class Results(models.Model):
    """Результаты"""

    name = models.CharField("Имя файла", max_length=100, default=None)
    status_file = models.BooleanField("Статус файла", default=False)
    datetime = models.CharField("Время", max_length=55, default=None)
    autoexec = models.CharField("Автоисполняемые", max_length=55, default=None)
    hex_obfuscated = models.CharField("Хекс обфусцированный", max_length=55, default=None)
    suspicious = models.CharField("Опасный", max_length=55, default=None)
    iocs = models.CharField("Ссылки", max_length=55, default=None)
    base64 = models.CharField("Base64", max_length=55, default=None)
    dridex_obfuscated = models.CharField("Dridex обфусцированный", max_length=55, default=None)
    vba_obfuscated = models.CharField("VBA обфусцированный", max_length=55, default=None)


    def __str__(self):
        return self.name

    class Meta:
        verbose_name = "Результат"
        verbose_name_plural = "Результаты"


class Triggers(models.Model):
    """Тригеры(уже проверенные файлы)"""

    name = models.CharField("Имя файла", max_length=100)
    id_triggers = models.PositiveIntegerField("Идентификатор тригера")
    hashsum = models.CharField("Хешсумма", max_length=100)
    status_file = models.ForeignKey(Results, verbose_name="Результат", on_delete=models.CASCADE)

    def __str__(self):
        return self.name

    class Meta:
        verbose_name = "Тригер"
        verbose_name_plural = "Тригеры"


class Details(models.Model):


    kwtype = models.CharField("Тип файла", max_length=20)
    keyword = models.CharField("Строка", max_length=55)
    descr = models.CharField("Описание", max_length=55)

    def __str__(self):
        return self.kwtype


    class Meta:
        verbose_name = "Описание"

