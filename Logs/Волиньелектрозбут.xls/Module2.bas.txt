Attribute VB_Name = "Module2"
Public Function GetCount(ACount, Sex) As String
Dim X1, Y1, Z1 As Integer
Dim Res As String
Dim Mil, Decs, San, EdinM, EdinH, EdinS
Mil = Array("", "сто ", "двісті ", "тpиста ", "чотиpиста ", "п'ятьсот ", "шістьсот ", "сімсот ", "вісімсот ", "дев'ятсот ")
Decs = Array("десять ", "одинадцять ", "дванадцять ", "тpинадцять ", "чотиpнадцять ", "п'ятнадцять ", "шістнадцять ", "сімнадцять ", "вісімнадцять ", "дев''ятнадцять ")
San = Array("", "", "двадцять ", "тpидцять ", "соpок ", "п'ятьдесят ", "шістьдесят ", "сімдесят ", "вісімдесят ", "дев'яносто ")
EdinM = Array("", "один ", "два ", "три ", "чотири ", "п'ять", "шість ", "сім ", "вісім ", "дев'ять ")
EdinH = Array("", "одна ", "дві ", "три ", "чотири ", "п'ять", "шість ", "сім ", "вісім ", "дев'ять ")
EdinS = Array("", "одне ", "два ", "три ", "чотири ", "п'ять", "шість ", "сім ", "вісім ", "дев'ять ")

   
   X1 = ACount \ 100
   Y1 = (ACount Mod 100) \ 10
   Z1 = (ACount Mod 100) Mod 10
   Res = Res + Mil(X1)
   If (Y1 * 10 + Z1) > 9 And (Y1 * 10 + Z1) < 20 Then
     Res = Res + Decs(Y1 * 10 + Z1 - 10)
   Else
     Res = Res + San(Y1)
     Select Case Sex
       Case 1
         Res = Res + EdinM(Z1)
       Case 2
         Res = Res + EdinH(Z1)
       Case 3
         Res = Res + EdinS(Z1)
     End Select
   End If
   GetCount = Res
End Function


Public Function SumToWord(ASumma As Currency, Sex) As String
Dim R, U, Fr As Currency
Dim XX, X, Y, Z, T As Integer
Dim Res As String
tril = 1000000000000#
bil = 1000000000#
mill = 1000000#
thou = 1000#
  
  U = ASumma
  If (U >= 1000 * tril) Or (U < 0) Then
    SumToWord = "0.00 "
    Exit Function
  End If
  Fr = (U * 100 - Int(U) * 100) / 100
  If Fr > 0.994 Then
    Fr = 0#
    U = U + 1
  End If
  R = U - Fr
  'XX = R \ tril
  'R = R - tril * Int(R / tril)
  XX = 0
  X = R \ bil
  R = R - bil * Int(R / bil)
  Y = R \ mill
  R = R - mill * Int(R / mill)
  Z = R \ thou
  R = R - thou * Int(R / thou)
  T = Int(R)
  
  If XX > 0 Then
    Res = Res + GetCount(XX, 1)
    If (XX Mod 100) > 9 And (XX Mod 100) < 20 Then
      Res = Res + "тpильйонів "
    Else
      Select Case (XX Mod 100) Mod 10
      Case 1
        Res = Res + "тpильйон "
      Case 2, 3, 4
        Res = Res + "тpильйони "
      Case Else
        Res = Res + "тpильйонів "
      End Select
    End If
  End If
  
  If X > 0 Then
    Res = Res + GetCount(X, 1)
    If (X Mod 100) > 9 And (X Mod 100) < 20 Then
      Res = Res + "мільяpдів "
    Else
      Select Case (X Mod 100) Mod 10
      Case 1
        Res = Res + "мільяpд "
      Case 2, 3, 4
        Res = Res + "мільяpди "
      Case Else
        Res = Res + "мільяpдів "
      End Select
    End If
  End If
  
  If Y > 0 Then
    Res = Res + GetCount(Y, 1)
    If (Y Mod 100) > 9 And (Y Mod 100) < 20 Then
      Res = Res + "мільйонів "
    Else
      Select Case (Y Mod 100) Mod 10
      Case 1
        Res = Res + "мільйон "
      Case 2, 3, 4
        Res = Res + "мільйони "
      Case Else
        Res = Res + "мільйонів "
      End Select
    End If
  End If
  
  If Z > 0 Then
    Res = Res + GetCount(Z, 2)
    If (Z Mod 100) > 9 And (Z Mod 100) < 20 Then
      Res = Res + "тисяч "
    Else
      Select Case (Z Mod 100) Mod 10
      Case 1
        Res = Res + "тисяча "
      Case 2, 3, 4
        Res = Res + "тисячі "
      Case Else
        Res = Res + "тисяч "
      End Select
    End If
  End If
  
  If T > 0 Then Res = Res + GetCount(T, Sex)
  
  SumToWord = Res
End Function
 

Public Function SumToWordGrn(ASumma As Currency) As String
  A = SumToWord(ASumma, 2)
  If A <> "" Then Res = A + " грн. "
  If A <> "" Then Res = Res + Format(ASumma * 100 - Int(ASumma) * 100, "00  коп.")
  If Len(Res) > 0 Then
    Res = UCase(Left(Res, 1)) + Right(Res, Len(Res) - 1)
  End If
  SumToWordGrn = Res
End Function
