Attribute VB_Name = "Лист2"
Attribute VB_Base = "0{00020820-0000-0000-C000-000000000046}"
Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = True
Attribute VB_Exposed = True
Attribute VB_TemplateDerived = False
Attribute VB_Customizable = True
'' © НКРЕ Вербицький Михайло Миколайович 2009р.
'Private Sub Worksheet_SelectionChange(ByVal Target As Range)
'    If (Union(Target.Cells, Range("I14:AI14")).Address = Range("I14:AI14").Address) Then 'назва компанії
'        v = Replace(Range("I14").Value, Chr(10), "; ")
'        If InStr(1, v, "; ", 0) = 0 Then
'            UserSelect.ComboBox1.Value = v
'            UserSelect.ComboBox1.SetFocus
'        Else
'            With UserSelect.ListBox1
'                For i = 0 To .ListCount - 1
'                    If InStr(1, v, .List(i), 0) <> 0 Then .Selected(i) = True
'                Next i
'            End With
'            UserSelect.ListBox1.SetFocus
'        End If
'        UserSelect.Label3.Caption = v
'        UserSelect.Show
'    Else: 'ListBox1.Visible = False
'    End If
'End Sub
'
'
'Private Sub Worksheet_Activate()
'    Application.EnableEvents = False
'    Application.ScreenUpdating = False
'    ЛистБД.Activate
'    Nend = IIf(ActiveSheet.Range("E65500").End(xlUp).Row > 23, ActiveSheet.Range("E65500").End(xlUp).Row + 1, 24)
'    ЛистБД.Range("E14:BI" & Nend + 8).Select
'    Selection.AutoFilter
'    Selection.AutoFilter
'    Лист2.Activate
'    Application.ScreenUpdating = True
'    Application.EnableEvents = True
'End Sub
'Private Sub Worksheet_Change(ByVal Target As Range)
'    If (Union(Target.Cells, Range("I14:AI14,R9:T9,V9")).Address = Range("I14:AI14,R9:T9,V9").Address) Then
'        Application.EnableEvents = False
'        Лист2.Range("AR51:AR" & Лист2.Range("AR65500").End(xlUp).Row + 1).ClearContents
'        Call Tab2Free("-")
'        If Лист2.Range("I14").Value = "" Then Application.EnableEvents = True: End
'        Call filter(Лист2.Range("I14").Value, Лист2.Range("R9").Value, Лист2.Range("V9").Value)
'        Application.EnableEvents = True
'    End If
'End Sub
'Private Sub filter(PEMname As String, Per As String, year As String)
'    PEMname = Replace(PEMname, Chr(10), "; ")
'    Kod = ""
'    For i = 51 To Лист2.Range("AZ65500").End(xlUp).Row
'        If InStr(1, PEMname, Лист2.Range("AZ" & i).Value, 0) <> 0 Then Kod = Лист2.Range("BA" & i).Value & "; " & Kod
'    Next i
'    Select Case Per
'        Case "I квартал"
'            Per = "Січень Лютий Березень"
'        Case "II квартал"
'            Per = "Квітень Травень Червень"
'        Case "III квартал"
'            Per = "Липень Серпень Вересень"
'        Case "IV квартал"
'            Per = "Жовтень Листопад Грудень"
'    End Select
'    Dim rediIs As Boolean
'    rediIs = False
'    Kend = IIf(ЛистБД.Range("F65500").End(xlUp).Row > 14, (ЛистБД.Range("F65500").End(xlUp).Row - 14) / 9, 0)
'    For k = 1 To Kend
'        If InStr(1, Kod, ЛистБД.Range("H" & 15 + k * 9).Value, vbTextCompare) = 0 And InStr(1, Kod, Mid(ЛистБД.Range("E" & 15 + k * 9).Value, 4, 5) & "; ", vbTextCompare) = 0 Then GoTo NextK
'        If InStr(1, Per, ЛистБД.Range("G" & 15 + k * 9).Value, 0) = 0 And Per <> "" Then GoTo NextK
'        If StrComp(ЛистБД.Range("F" & 15 + k * 9).Value, year, vbTextCompare) <> 0 And year <> "" Then GoTo NextK
'
'        rediIs = False
'        For i = 51 To Лист2.Range("AR65500").End(xlUp).Row
'            If StrComp(ЛистБД.Range("H" & 15 + k * 9).Value, Лист2.Range("AR" & i).Value, vbTextCompare) = 0 Then rediIs = True: Exit For
'        Next i
'        '------------------------------------------------------------------------------
'        For i = 1 To 6
'            For j = 1 To 8
'                kPEM = sPEM2n(j, k)
'                kSV = s2n(j)
'                If rediIs = False Then
'                    Sum = kPEM + kSV
'                Else
'                    Sum = kSV
'                End If
'                Y = j + 14 + k * 9
'                If NVal(Лист2.Range("SAIDI").Cells(j, i).Value) > 0 Or ЛистБД.Cells(Y, i + 11).Value > 0 Then Лист2.Range("SAIDI").Cells(j, i).Value = (NVal(Лист2.Range("SAIDI").Cells(j, i).Value) * kSV + ЛистБД.Cells(Y, i + 11).Value * kPEM) / Sum
'                If NVal(Лист2.Range("SAIFI").Cells(j, i).Value) > 0 Or ЛистБД.Cells(Y, i + 18).Value > 0 Then Лист2.Range("SAIFI").Cells(j, i).Value = (NVal(Лист2.Range("SAIFI").Cells(j, i).Value) * kSV + ЛистБД.Cells(Y, i + 18).Value * kPEM) / Sum
'                If NVal(Лист2.Range("ENS").Cells(j, i).Value) > 0 Or ЛистБД.Cells(Y, i + 25).Value > 0 Then Лист2.Range("ENS").Cells(j, i).Value = NVal(Лист2.Range("ENS").Cells(j, i).Value) + ЛистБД.Cells(Y, i + 25).Value
'                If NVal(Лист2.Range("MAIFI").Cells(j, i).Value) > 0 Or ЛистБД.Cells(Y, i + 32).Value > 0 Then Лист2.Range("MAIFI").Cells(j, i).Value = (NVal(Лист2.Range("MAIFI").Cells(j, i).Value) * kSV + ЛистБД.Cells(Y, i + 32).Value * kPEM) / Sum
'                If NVal(Лист2.Range("NS").Cells(j, i).Value) > 0 Or ЛистБД.Cells(Y, i + 47).Value > 0 Then Лист2.Range("NS").Cells(j, i).Value = NVal(Лист2.Range("NS").Cells(j, i).Value) + ЛистБД.Cells(Y, i + 47).Value
'                If NVal(Лист2.Range("NM").Cells(j, i).Value) > 0 Or ЛистБД.Cells(Y, i + 54).Value > 0 Then Лист2.Range("NM").Cells(j, i).Value = NVal(Лист2.Range("NM").Cells(j, i).Value) + ЛистБД.Cells(Y, i + 54).Value
'            Next j
'        Next i
'        '------------------------------------------------------------------------------
'        If rediIs = False Then
'            Лист2.Range("AR" & Лист2.Range("AR65500").End(xlUp).Row + 1).Value = ЛистБД.Range("H" & 15 + k * 9).Value
'
'            For j = 1 To 2
'            'точки
'                If ЛистБД.Range("AN" & j + 14 + k * 9).Value <> 0 Then Лист2.Range("zag1").Cells(j, 1).Value = Лист2.Range("zag1").Cells(j, 1).Value + ЛистБД.Range("AN" & j + 14 + k * 9).Value
'                If ЛистБД.Range("AN" & j + 17 + k * 9).Value <> 0 Then Лист2.Range("zag2").Cells(j, 1).Value = Лист2.Range("zag2").Cells(j, 1).Value + ЛистБД.Range("AN" & j + 17 + k * 9).Value
'                If ЛистБД.Range("AN" & j + 20 + k * 9).Value <> 0 Then Лист2.Range("zag3").Cells(j, 1).Value = Лист2.Range("zag3").Cells(j, 1).Value + ЛистБД.Range("AN" & j + 20 + k * 9).Value
'
'            'споживання
'                If ЛистБД.Range("AO" & j + 14 + k * 9).Value <> 0 Then Лист2.Range("zag1").Cells(j, 2).Value = Лист2.Range("zag1").Cells(j, 2).Value + ЛистБД.Range("AO" & j + 14 + k * 9).Value
'                If ЛистБД.Range("AO" & j + 17 + k * 9).Value <> 0 Then Лист2.Range("zag2").Cells(j, 2).Value = Лист2.Range("zag2").Cells(j, 2).Value + ЛистБД.Range("AO" & j + 17 + k * 9).Value
'                If ЛистБД.Range("AO" & j + 20 + k * 9).Value <> 0 Then Лист2.Range("zag3").Cells(j, 2).Value = Лист2.Range("zag3").Cells(j, 2).Value + ЛистБД.Range("AO" & j + 20 + k * 9).Value
'            Next j
'        End If
'NextK:
'    Next k
'End Sub
'Private Sub Tab2Free(text As String)
'    Лист2.Range("SAIDI").Value = text
'    Лист2.Range("SAIFI").Value = text
'    Лист2.Range("ENS").Value = text
'    Лист2.Range("MAIFI").Value = text
'    Лист2.Range("NS").Value = text
'    Лист2.Range("NM").Value = text
'
'    Лист2.Range("zag1").ClearContents
'    Лист2.Range("zag2").ClearContents
'    Лист2.Range("zag3").ClearContents
'End Sub
'Function s2n(stroka)
'    Select Case stroka
'        Case 1 To 3, 6
'            s2n = Лист2.Range("zag1").Cells(1, 1).Value + Лист2.Range("zag1").Cells(2, 1).Value + Лист2.Range("zag2").Cells(1, 1).Value + Лист2.Range("zag2").Cells(2, 1).Value + Лист2.Range("zag3").Cells(1, 1).Value + Лист2.Range("zag3").Cells(2, 1).Value
'        Case 4, 7
'            s2n = Лист2.Range("zag1").Cells(1, 1).Value + Лист2.Range("zag1").Cells(2, 1).Value + Лист2.Range("zag2").Cells(1, 1).Value + Лист2.Range("zag3").Cells(1, 1).Value
'        Case 5, 8
'            s2n = Лист2.Range("zag2").Cells(2, 1).Value + Лист2.Range("zag3").Cells(2, 1).Value
'    End Select
'End Function
'Function sPEM2n(stroka, k)
'    Select Case stroka
'        Case 1 To 3, 6
'            sPEM2n = ЛистБД.Range("AN" & 23 + k * 9).Value
'        Case 4, 7
'            sPEM2n = ЛистБД.Range("AN" & 15 + k * 9).Value + ЛистБД.Range("AN" & 16 + k * 9).Value + ЛистБД.Range("AN" & 18 + k * 9).Value + ЛистБД.Range("AN" & 21 + k * 9).Value
'        Case 5, 8
'            sPEM2n = ЛистБД.Range("AN" & 19 + k * 9).Value + ЛистБД.Range("AN" & 22 + k * 9).Value
'    End Select
'End Function
'Function NVal(Target)
'    Target = Replace(Target, ",", ".")
'    NVal = Val(Target)
'End Function
'' © НКРЕ Вербицький Михайло Миколайович 2009р.
'
'
